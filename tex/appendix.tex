\small{

% add comparison with results from APBS
\section{Agreement of solvation energy calculations with APBS} \label{comparison}
We build more confidence on Bempp-Exafmm by comparing our results with the finite-difference version of APBS (version 1.5), using 5PTI and 8 other molecules.
We prepared the molecular structures using the \texttt{charmm} force field.
For each molecule, we created three successive meshes to study the convergence with each software.
For Bempp-Exafmm, we used \texttt{Nanoshaper} to generate three surface meshes with the element density set to 4, 8, 16 ${\si{\angstrom}}^{-2}$, respectively.
In APBS, we controlled the multigrid parameters to ensure that three grid spacings are refined with a constant factor of 2.
Table \ref{tab:APBS_mesh} summarizes the mesh sizes of the molecules used in the convergence study of APBS and Bempp.
The former uses Cartesian grids while the latter uses surface meshes generated by \texttt{Nanoshaper}.
Other parameters are the same as our previous grid-convergence study, as listed in Table \ref{tab:convergence}.

Table \ref{tab:APBS_result} presents the convergence results of both codes using a set of molecules.
Bempp used the derivative formulation throughout.
In each case, we obtained an extrapolated value of the solvation energy of each molecule, which serves as the reference value to estimate the discretization error with each software.
As expected, the solvation energy computed from Bempp converges at the rate of $\mathcal{O}(N^{-1})$, where $N$ is the number of elements.
With APBS, the average observed order of convergence over all cases is 1.25, with respect to the grid spacing $h$; other studies \cite{CooperBardhanBarba2014,GengKrasny2013} have reported a similar rate. 
Our $\mathcal{O}(N^{-1})$ convergence corresponds to $\mathcal{O}(h^{-2})$ convergence in grid size, but for boundary elements (surface triangles) it is more natural to look at convergence with respect to $N$.
The difference in the extrapolated solvation energies obtained with the two codes varies between 0.8\% and 1.8\% across all cases.
A discrepancy is expected because Bempp-Exafmm and APBS use different geometrical representations for the molecular surface, while the atomic charges in the molecule are mapped to grid points through interpolation in APBS.

\begin{table}[]
    \centering
    \resizebox{\columnwidth}{!}{%
    \begin{tabular}{c|ccc|ccc}
    \multirow{2}{*}{ID} & \multicolumn{3}{c|}{APBS} & \multicolumn{3}{c}{Bempp} \\
                        & coarse  & medium  & fine & coarse  & medium  & fine   \\ \hline
    1AJJ                & $65 ^3$     & $129^3$     & $257^3$  & 8544    & 17200   & 34468  \\
    1VJW                & $97 ^3$     & $193^3$     & $385^3$  & 11544   & 23296   & 46660  \\
    5PTI                & $97 ^3$     & $193^3$     & $385^3$  & 12512   & 25204   & 50596  \\
    1R69                & $97 ^3$     & $193^3$     & $385^3$  & 12004   & 24216   & 48648  \\
    1A2S                & $65 ^3$     & $129^3$     & $257^3$  & 17784   & 35732   & 71648  \\
    1SVR                & $97 ^3$     & $193^3$     & $385^3$  & 18644   & 37348   & 75004  \\
    1A63                & $129^3$     & $257^3$     & $513^3$  & 27996   & 56356   & 113124 \\
    1A7M                & $129^3$     & $257^3$     & $513^3$  & 30576   & 61652   & 123776 \\
    1F6W                & $129^3$     & $257^3$     & $513^3$  & 77464   & 156140  & 313692
    \end{tabular}
    }
    \caption{Mesh sizes of the molecules used in the convergence study of APBS and Bempp.}
    \label{tab:APBS_mesh}
\end{table}

\begin{table*}[]
    \centering
    \resizebox{\textwidth}{!}{%
    \begin{tabular}{cc|ccc|cc|ccc|cc}
      &   & \multicolumn{5}{c|}{APBS}                                                                    & \multicolumn{5}{c}{Bempp}                                                                   \\
      &   & \multicolumn{3}{c|}{Error}     & \multirow{2}{*}{$\Delta G_{solv}$} & \multirow{2}{*}{Order$(1/h)$} & \multicolumn{3}{c|}{Error}     & \multirow{2}{*}{$\Delta G_{solv}$} & \multirow{2}{*}{Order$(1/N)$} \\
    ID   & $N_{atoms}$ & coarse   & medium   & fine     &                                    &                        & coarse   & medium   & fine     &                                    &                        \\ \hline
    1AJJ & 513 & 4.40e-02 & 1.33e-02 & 4.00e-03 & -266.15                            & 1.73                   & 2.75e-02 & 1.12e-02 & 4.59e-03 & -268.67                            & 1.29                   \\
    1VJW & 826 & 3.09e-02 & 1.45e-02 & 6.77e-03 & -297.06                            & 1.09                   & 4.92e-02 & 2.23e-02 & 1.01e-02 & -302.50                            & 1.14                   \\
    5PTI & 892 & 3.68e-02 & 1.38e-02 & 5.14e-03 & -311.69                            & 1.42                   & 5.12e-02 & 2.23e-02 & 9.67e-03 & -314.34                            & 1.20                   \\
    1R69 & 997 & 4.31e-02 & 2.10e-02 & 1.02e-02 & -261.02                            & 1.04                   & 5.09e-02 & 2.34e-02 & 1.08e-02 & -265.02                            & 1.12                   \\
    1A2S & 1272 & 5.25e-02 & 2.40e-02 & 1.10e-02 & -456.56                            & 1.13                   & 4.21e-02 & 1.93e-02 & 8.86e-03 & -461.25                            & 1.12                   \\
    1SVR & 1433 & 5.28e-02 & 2.21e-02 & 9.28e-03 & -393.45                            & 1.25                   & 6.48e-02 & 2.89e-02 & 1.29e-02 & -398.83                            & 1.16                   \\
    1A63 & 2065 & 4.51e-02 & 1.88e-02 & 7.82e-03 & -559.39                            & 1.26                   & 5.82e-02 & 2.60e-02 & 1.16e-02 & -567.24                            & 1.16                   \\
    1A7M & 2804 & 4.13e-02 & 1.88e-02 & 8.53e-03 & -524.29                            & 1.14                   & 4.93e-02 & 2.24e-02 & 1.02e-02 & -531.48                            & 1.14                   \\
    1F6W & 8247 & 6.45e-02 & 2.78e-02 & 1.20e-02 & -1277.51                           & 1.21                   & 4.18e-02 & 1.80e-02 & 7.76e-03 & -1301.08                           & 1.22                     
    \end{tabular}
    }
    \caption{Convergence results of the solvation energy of 9 molecules using APBS and Bempp with derivative formulation.
    The error is with respect to an extrapolated value of the solvation energy using Richardson extrapolation.
    The solvation energy $\Delta G_{solv}$ is in units of kcal/mol.
    The observed order of convergence is with respect to the grid spacing $h$ for APBS (volumetric-based solver) and with respect to the number of elements $N$ for Bempp (boundary-element solver).}
    \label{tab:APBS_result}
\end{table*}

}
